{
  throwIfNotOnMainThread();
  final String cacheKey=getCacheKey(requestUrl,maxWidth,maxHeight,scaleType);
  Bitmap cachedBitmap=mCache.getBitmap(cacheKey);
  if (cachedBitmap != null) {
    ImageContainer container=new ImageContainer(cachedBitmap,requestUrl,null,null);
    imageListener.onResponse(container,true);
    return container;
  }
  ImageContainer imageContainer=new ImageContainer(null,requestUrl,cacheKey,imageListener);
  imageListener.onResponse(imageContainer,true);
  BatchedImageRequest request=mInFlightRequests.get(cacheKey);
  if (request != null) {
    request.addContainer(imageContainer);
    return imageContainer;
  }
  Request<Bitmap> newRequest=makeImageRequest(requestUrl,maxWidth,maxHeight,scaleType,cacheKey);
  mRequestQueue.add(newRequest);
  mInFlightRequests.put(cacheKey,new BatchedImageRequest(newRequest,imageContainer));
  return imageContainer;
}
