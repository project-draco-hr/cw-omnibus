{
  if ((maxPrimary == 0) && (maxSecondary == 0)) {
    return actualPrimary;
  }
  if (scaleType == ScaleType.FIT_XY) {
    if (maxPrimary == 0) {
      return actualPrimary;
    }
    return maxPrimary;
  }
  if (maxPrimary == 0) {
    double ratio=(double)maxSecondary / (double)actualSecondary;
    return (int)(actualPrimary * ratio);
  }
  if (maxSecondary == 0) {
    return maxPrimary;
  }
  double ratio=(double)actualSecondary / (double)actualPrimary;
  int resized=maxPrimary;
  if (scaleType == ScaleType.CENTER_CROP) {
    if ((resized * ratio) < maxSecondary) {
      resized=(int)(maxSecondary / ratio);
    }
    return resized;
  }
  if ((resized * ratio) > maxSecondary) {
    resized=(int)(maxSecondary / ratio);
  }
  return resized;
}
