{
  final int action=event.getAction();
  final int x=(int)event.getX();
  final int y=(int)event.getY();
  boolean result=false;
  if (action == MotionEvent.ACTION_DOWN) {
    for (    OverlayItem item : items) {
      Point p=new Point(0,0);
      map.getProjection().toPixels(item.getPoint(),p);
      if (hitTest(item,marker,x - p.x,y - p.y)) {
        result=true;
        inDrag=item;
        items.remove(inDrag);
        populate();
        xDragTouchOffset=0;
        yDragTouchOffset=0;
        setDragImagePosition(p.x,p.y);
        dragImage.setVisibility(View.VISIBLE);
        xDragTouchOffset=x - p.x;
        yDragTouchOffset=y - p.y;
        break;
      }
    }
  }
 else   if (action == MotionEvent.ACTION_MOVE && inDrag != null) {
    setDragImagePosition(x,y);
    result=true;
  }
 else   if (action == MotionEvent.ACTION_UP && inDrag != null) {
    dragImage.setVisibility(View.GONE);
    GeoPoint pt=map.getProjection().fromPixels(x - xDragTouchOffset,y - yDragTouchOffset);
    OverlayItem toDrop=new OverlayItem(pt,inDrag.getTitle(),inDrag.getSnippet());
    items.add(toDrop);
    populate();
    inDrag=null;
    result=true;
  }
  return (result || super.onTouchEvent(event,mapView));
}
